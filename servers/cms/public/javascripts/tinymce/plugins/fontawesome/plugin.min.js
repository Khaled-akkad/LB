// Created by Josh Hunt
// joshhunt180@gmail.com
// v1.4.0
tinymce.PluginManager.add('fontawesome', function (editor, url) {
	
	webApplicationIcons = [
		['adjust'],
		['anchor'],
		['archive'],
		['area-chart'],
		['arrows'],
		['arrows-h'],
		['arrows-v'],
		['asterisk'],
		['at'],
		['automobile'],
		['ban'],
		['bank'],
		['bar-chart'],
		['bar-chart-o'],
		['barcode'],
		['bars'],
		['bed'],
		['beer'],
		['bell'],
		['bell-o'],
		['bell-slash'],
		['bell-slash-o'],
		['bicycle'],
		['binoculars'],
		['birthday-cake'],
		['bolt'],
		['bomb'],
		['book'],
		['bookmark'],
		['bookmark-o'],
		['briefcase'],
		['bug'],
		['building'],
		['building-o'],
		['bullhorn'],
		['bullseye'],
		['bus'],
		['cab'],
		['calculator'],
		['calendar'],
		['calendar-o'],
		['camera'],
		['camera-retro'],
		['car'],
		['caret-square-o-down'],
		['caret-square-o-left'],
		['caret-square-o-right'],
		['caret-square-o-up'],
		['cart-arrow-down'],
		['cart-plus'],
		['cc'],
		['certificate'],
		['check'],
		['check-circle'],
		['check-circle-o'],
		['check-square'],
		['check-square-o'],
		['child'],
		['circle'],
		['circle-o'],
		['circle-o-notch'],
		['circle-thin'],
		['clock-o'],
		['close'],
		['cloud'],
		['cloud-download'],
		['cloud-upload'],
		['code'],
		['code-fork'],
		['coffee'],
		['cog'],
		['cogs'],
		['comment'],
		['comment-o'],
		['comments'],
		['comments-o'],
		['compass'],
		['copyright'],
		['credit-card'],
		['crop'],
		['crosshairs'],
		['cube'],
		['cubes'],
		['cutlery'],
		['dashboard'],
		['database'],
		['desktop'],
		['diamond'],
		['dot-circle-o'],
		['download'],
		['edit'],
		['ellipsis-h'],
		['ellipsis-v'],
		['envelope'],
		['envelope-o'],
		['envelope-square'],
		['eraser'],
		['exchange'],
		['exclamation'],
		['exclamation-circle'],
		['exclamation-triangle'],
		['external-link'],
		['external-link-square'],
		['eye'],
		['eye-slash'],
		['eyedropper'],
		['fax'],
		['female'],
		['fighter-jet'],
		['file-archive-o'],
		['file-audio-o'],
		['file-code-o'],
		['file-excel-o'],
		['file-image-o'],
		['file-movie-o'],
		['file-pdf-o'],
		['file-photo-o'],
		['file-picture-o'],
		['file-powerpoint-o'],
		['file-sound-o'],
		['file-video-o'],
		['file-word-o'],
		['file-zip-o'],
		['film'],
		['filter'],
		['fire'],
		['fire-extinguisher'],
		['flag'],
		['flag-checkered'],
		['flag-o'],
		['flash'],
		['flask'],
		['folder'],
		['folder-o'],
		['folder-open'],
		['folder-open-o'],
		['frown-o'],
		['futbol-o'],
		['gamepad'],
		['gavel'],
		['gear'],
		['gears'],
		['genderless'],
		['gift'],
		['glass'],
		['globe'],
		['graduation-cap'],
		['group'],
		['hdd-o'],
		['headphones'],
		['heart'],
		['heart-o'],
		['heartbeat'],
		['history'],
		['home'],
		['hotel'],
		['image'],
		['inbox'],
		['info'],
		['info-circle'],
		['institution'],
		['key'],
		['keyboard-o'],
		['language'],
		['laptop'],
		['leaf'],
		['legal'],
		['lemon-o'],
		['level-down'],
		['level-up'],
		['life-bouy'],
		['life-buoy'],
		['life-ring'],
		['life-saver'],
		['lightbulb-o'],
		['line-chart'],
		['location-arrow'],
		['lock'],
		['magic'],
		['magnet'],
		['mail-forward'],
		['mail-reply'],
		['mail-reply-all'],
		['male'],
		['map-marker'],
		['meh-o'],
		['microphone'],
		['microphone-slash'],
		['minus'],
		['minus-circle'],
		['minus-square'],
		['minus-square-o'],
		['mobile'],
		['mobile-phone'],
		['money'],
		['moon-o'],
		['mortar-board'],
		['motorcycle'],
		['music'],
		['navicon'],
		['newspaper-o'],
		['paint-brush'],
		['paper-plane'],
		['paper-plane-o'],
		['paw'],
		['pencil'],
		['pencil-square'],
		['pencil-square-o'],
		['phone'],
		['phone-square'],
		['photo'],
		['picture-o'],
		['pie-chart'],
		['plane'],
		['plug'],
		['plus'],
		['plus-circle'],
		['plus-square'],
		['plus-square-o'],
		['power-off'],
		['print'],
		['puzzle-piece'],
		['qrcode'],
		['question'],
		['question-circle'],
		['quote-left'],
		['quote-right'],
		['random'],
		['recycle'],
		['refresh'],
		['remove'],
		['reorder'],
		['reply'],
		['reply-all'],
		['retweet'],
		['road'],
		['rocket'],
		['rss'],
		['rss-square'],
		['search'],
		['search-minus'],
		['search-plus'],
		['send'],
		['send-o'],
		['server'],
		['share'],
		['share-alt'],
		['share-alt-square'],
		['share-square'],
		['share-square-o'],
		['shield'],
		['ship'],
		['shopping-cart'],
		['sign-in'],
		['sign-out'],
		['signal'],
		['sitemap'],
		['sliders'],
		['smile-o'],
		['soccer-ball-o'],
		['sort'],
		['sort-alpha-asc'],
		['sort-alpha-desc'],
		['sort-amount-asc'],
		['sort-amount-desc'],
		['sort-asc'],
		['sort-desc'],
		['sort-down'],
		['sort-numeric-asc'],
		['sort-numeric-desc'],
		['sort-up'],
		['space-shuttle'],
		['spinner'],
		['spoon'],
		['square'],
		['square-o'],
		['star'],
		['star-half'],
		['star-half-empty'],
		['star-half-full'],
		['star-half-o'],
		['star-o'],
		['street-view'],
		['suitcase'],
		['sun-o'],
		['support'],
		['tablet'],
		['tachometer'],
		['tag'],
		['tags'],
		['tasks'],
		['taxi'],
		['terminal'],
		['thumb-tack'],
		['thumbs-down'],
		['thumbs-o-down'],
		['thumbs-o-up'],
		['thumbs-up'],
		['ticket'],
		['times'],
		['times-circle'],
		['times-circle-o'],
		['tint'],
		['toggle-down'],
		['toggle-left'],
		['toggle-off'],
		['toggle-on'],
		['toggle-right'],
		['toggle-up'],
		['trash'],
		['trash-o'],
		['tree'],
		['trophy'],
		['truck'],
		['tty'],
		['umbrella'],
		['university'],
		['unlock'],
		['unlock-alt'],
		['unsorted'],
		['upload'],
		['user'],
		['user-plus'],
		['user-secret'],
		['user-times'],
		['users'],
		['video-camera'],
		['volume-down'],
		['volume-off'],
		['volume-up'],
		['warning'],
		['wheelchair'],
		['wifi'],
		['wrench']
	]
	
	brandIcons = [
		['adn'],
		['android'],
		['angellist'],
		['apple'],
		['behance'],
		['behance-square'],
		['bitbucket'],
		['bitbucket-square'],
		['bitcoin'],
		['btc'],
		['buysellads'],
		['cc-amex'],
		['cc-discover'],
		['cc-mastercard'],
		['cc-paypal'],
		['cc-stripe'],
		['cc-visa'],
		['codepen'],
		['connectdevelop'],
		['css3'],
		['dashcube'],
		['delicious'],
		['deviantart'],
		['digg'],
		['dribbble'],
		['dropbox'],
		['drupal'],
		['empire'],
		['facebook'],
		['facebook-f'],
		['facebook-official'],
		['facebook-square'],
		['flickr'],
		['forumbee'],
		['foursquare'],
		['ge'],
		['git'],
		['git-square'],
		['github'],
		['github-alt'],
		['github-square'],
		['gittip'],
		['google'],
		['google-plus'],
		['google-plus-square'],
		['google-wallet'],
		['gratipay'],
		['hacker-news'],
		['html5'],
		['instagram'],
		['ioxhost'],
		['joomla'],
		['jsfiddle'],
		['lastfm'],
		['lastfm-square'],
		['leanpub'],
		['linkedin'],
		['linkedin-square'],
		['linux'],
		['maxcdn'],
		['meanpath'],
		['medium'],
		['openid'],
		['pagelines'],
		['paypal'],
		['pied-piper'],
		['pied-piper-alt'],
		['pinterest'],
		['pinterest-p'],
		['pinterest-square'],
		['qq'],
		['ra'],
		['rebel'],
		['reddit'],
		['reddit-square'],
		['renren'],
		['sellsy'],
		['share-alt'],
		['share-alt-square'],
		['shirtsinbulk'],
		['simplybuilt'],
		['skyatlas'],
		['skype'],
		['slack'],
		['slideshare'],
		['soundcloud'],
		['spotify'],
		['stack-exchange'],
		['stack-overflow'],
		['steam'],
		['steam-square'],
		['stumbleupon'],
		['stumbleupon-circle'],
		['tencent-weibo'],
		['trello'],
		['tumblr'],
		['tumblr-square'],
		['twitch'],
		['twitter'],
		['twitter-square'],
		['viacoin'],
		['vimeo-square'],
		['vine'],
		['vk'],
		['wechat'],
		['weibo'],
		['weixin'],
		['whatsapp'],
		['windows'],
		['wordpress'],
		['xing'],
		['xing-square'],
		['yahoo'],
		['yelp'],
		['youtube'],
		['youtube-play'],
		['youtube-square']
	]
	
	directionalIcons = [
		['angle-double-down'],
		['angle-double-left'],
		['angle-double-right'],
		['angle-double-up'],
		['angle-down'],
		['angle-left'],
		['angle-right'],
		['angle-up'],
		['arrow-circle-down'],
		['arrow-circle-left'],
		['arrow-circle-o-down'],
		['arrow-circle-o-left'],
		['arrow-circle-o-right'],
		['arrow-circle-o-up'],
		['arrow-circle-right'],
		['arrow-circle-up'],
		['arrow-down'],
		['arrow-left'],
		['arrow-right'],
		['arrow-up'],
		['arrows'],
		['arrows-alt'],
		['arrows-h'],
		['arrows-v'],
		['caret-down'],
		['caret-left'],
		['caret-right'],
		['caret-square-o-down'],
		['caret-square-o-left'],
		['caret-square-o-right'],
		['caret-square-o-up'],
		['caret-up'],
		['chevron-circle-down'],
		['chevron-circle-left'],
		['chevron-circle-right'],
		['chevron-circle-up'],
		['chevron-down'],
		['chevron-left'],
		['chevron-right'],
		['chevron-up'],
		['hand-o-down'],
		['hand-o-left'],
		['hand-o-right'],
		['hand-o-up'],
		['long-arrow-down'],
		['long-arrow-left'],
		['long-arrow-right'],
		['long-arrow-up'],
		['toggle-down'],
		['toggle-left'],
		['toggle-right'],
		['toggle-up']
	]
	
	textEditorIcons = [
		['align-center'],
		['align-justify'],
		['align-left'],
		['align-right'],
		['bold'],
		['chain'],
		['chain-broken'],
		['clipboard'],
		['columns'],
		['copy'],
		['cut'],
		['dedent'],
		['eraser'],
		['file'],
		['file-o'],
		['file-text'],
		['file-text-o'],
		['files-o'],
		['floppy-o'],
		['font'],
		['header'],
		['indent'],
		['italic'],
		['link'],
		['list'],
		['list-alt'],
		['list-ol'],
		['list-ul'],
		['outdent'],
		['paperclip'],
		['paragraph'],
		['paste'],
		['repeat'],
		['rotate-left'],
		['rotate-right'],
		['save'],
		['scissors'],
		['strikethrough'],
		['subscript'],
		['superscript'],
		['table'],
		['text-height'],
		['text-width'],
		['th'],
		['th-large'],
		['th-list'],
		['underline'],
		['undo'],
		['unlink']
	]
	
	videoPlayerIcons = [
		['arrows-alt'],
		['backward'],
		['compress'],
		['eject'],
		['expand'],
		['fast-backward'],
		['fast-forward'],
		['forward'],
		['pause'],
		['play'],
		['play-circle'],
		['play-circle-o'],
		['step-backward'],
		['step-forward'],
		['stop'],
		['youtube-play']
	]
	
	transportationIcons = [
		['ambulance'],
		['automobile'],
		['bicycle'],
		['bus'],
		['cab'],
		['car'],
		['fighter-jet'],
		['motorcycle'],
		['plane'],
		['rocket'],
		['ship'],
		['space-shuttle'],
		['subway'],
		['taxi'],
		['train'],
		['truck'],
		['wheelchair']
	]
	
	fileTypeIcons = [
		['file'],
		['file-archive-o'],
		['file-audio-o'],
		['file-code-o'],
		['file-excel-o'],
		['file-image-o'],
		['file-movie-o'],
		['file-o'],
		['file-pdf-o'],
		['file-photo-o'],
		['file-picture-o'],
		['file-powerpoint-o'],
		['file-sound-o'],
		['file-text'],
		['file-text-o'],
		['file-video-o'],
		['file-word-o'],
		['file-zip-o']
	]
	
	genderIcons = [
		['circle-thin'],
		['genderless'],
		['mars'],
		['mars-double'],
		['mars-stroke'],
		['mars-stroke-h'],
		['mars-stroke-v'],
		['mercury'],
		['neuter'],
		['transgender'],
		['transgender-alt'],
		['venus'],
		['venus-double'],
		['venus-mars']
	]
	
	formControlIcons = [
		['check-square'],
		['check-square-o'],
		['circle'],
		['circle-o'],
		['dot-circle-o'],
		['minus-square'],
		['minus-square-o'],
		['plus-square'],
		['plus-square-o'],
		['square'],
		['square-o']
	]
	
	currencyIcons = [
		['bitcoin'],
		['btc'],
		['cny'],
		['dollar'],
		['eur'],
		['euro'],
		['gbp'],
		['ils'],
		['inr'],
		['jpy'],
		['krw'],
		['money'],
		['rmb'],
		['rouble'],
		['rub'],
		['ruble'],
		['rupee'],
		['shekel'],
		['sheqel'],
		['try'],
		['turkish-lira'],
		['usd'],
		['won'],
		['yen']
	]
	
	medicalIcons = [
		['ambulance'],
		['h-square'],
		['heart'],
		['heart-o'],
		['heartbeat'],
		['hospital-o'],
		['medkit'],
		['plus-square'],
		['stethoscope'],
		['user-md'],
		['wheelchair']
	]
	
	paymentIcons = [
		['cc-amex'],
		['cc-discover'],
		['cc-mastercard'],
		['cc-paypal'],
		['cc-stripe'],
		['cc-visa'],
		['credit-card'],
		['google-wallet'],
		['paypal']
	]
	
	spinnerIcons = [
		['circle-o-notch'],
		['cog'],
		['gear'],
		['refresh'],
		['spinner']
	]
	
	chartIcons = [
		['area-chart'],
		['bar-chart'],
		['bar-chart-o'],
		['line-chart'],
		['pie-chart']
	]

    function showDialog() {
		
        var win;
		
		var hideAccordion = 0;
		
		function groupHtml(iconGroup, iconTitle) {
		
			var gridHtml;
			
			if (hideAccordion == 0) {
				gridHtml = '<div class="mce-fontawesome-panel-accordion"><div class="mce-fontawesome-panel-title">' + iconTitle + '</div>';
				gridHtml += '<div class="mce-fontawesome-panel-table" style="height: auto;"><table role="presentation" cellspacing="0"><tbody>';
				hideAccordion = 1;
			}
			else {
				gridHtml = '<div class="mce-fontawesome-panel-accordion mce-fontawesome-panel-accordion-hide"><div class="mce-fontawesome-panel-title">' + iconTitle + '</div>';
				gridHtml += '<div class="mce-fontawesome-panel-table"><table role="presentation" cellspacing="0"><tbody>';
			}
	
			var width = 23;
			for (y = 0; y < (iconGroup.length / width); y++) {
				gridHtml += '<tr>';
	
				for (x = 0; x < width; x++) {
					if (iconGroup[y * width + x]) {
						if (iconTitle == "Spinner") {
							gridHtml += '<td><i class="fa fa-spin fa-' + iconGroup[y * width + x] + '"> </i></td>';
						}
						else {
							gridHtml += '<td><i class="fa fa-' + iconGroup[y * width + x] + '"> </i></td>';
						}
					}
				}
	
				gridHtml += '</tr>';
			}
	
			gridHtml += '</tbody></table></div></div>';
			
			return gridHtml;
		
		}
		
		var panelHtml = groupHtml(webApplicationIcons, "Web Application") + groupHtml(fileTypeIcons, "File Type") + groupHtml(spinnerIcons, "Spinner") + groupHtml(formControlIcons, "Form Control") + groupHtml(currencyIcons, "Currency") + groupHtml(textEditorIcons, "Text Editor") + groupHtml(directionalIcons, "Directional") + groupHtml(videoPlayerIcons, "Video Player") + groupHtml(brandIcons, "Brand") + groupHtml(medicalIcons, "Medical") + groupHtml(transportationIcons, "Transportation") + groupHtml(genderIcons, "Gender") + groupHtml(paymentIcons, "Payment") + groupHtml(chartIcons, "Chart");

        win = editor.windowManager.open({
			autoScroll: true,
			width: 670,
    		height: 500,
            title: "Icons",
			spacing: 20,
           	padding: 10,
			classes: 'fontawesome-panel',
			items: [
                {
				    type: 'container',
					html: panelHtml,
					onclick: function (e) {
					var target = e.target;
					if (target.nodeName == 'I') {
						editor.execCommand('mceInsertContent', false, target.outerHTML + " ");
						win.close();
					}
				},
				
				}, {
                    type: 'label',
                    text: ' '
                }
            ],
            buttons: [{
                text: "Close",
                onclick: function () {
                    win.close();
                }
            }]
        });
		
		// Accordion
		
		var accordionItems = new Array();
		
		var divs = document.getElementsByTagName('div');
		for (var i = 0; i < divs.length; i++) {
			if (divs[i].className == 'mce-fontawesome-panel-accordion' || divs[i].className == 'mce-fontawesome-panel-accordion mce-fontawesome-panel-accordion-hide') {
				accordionItems.push(divs[i])
			}
		}
		
		// Assign onclick events to the accordion item headings
		for (var i = 0; i < accordionItems.length; i++) {
			var accordionTitle = getFirstChildWithTagName(accordionItems[i], 'DIV');
			accordionTitle.onclick = toggleItem;
		}
		
		var firstDiv = accordionItems[0].getElementsByTagName('div')[1];
		var firstDivHeight = firstDiv.offsetHeight;
		firstDiv.style.height = firstDivHeight + 'px';
		
		function toggleItem() {
			var itemClass = this.parentNode.className;
			
			// Hide all items
			for (var i = 0; i < accordionItems.length; i++) {
				accordionItems[i].className = 'mce-fontawesome-panel-accordion mce-fontawesome-panel-accordion-hide';
				accordionItems[i].getElementsByTagName('div')[1].style.height = "0";
			}
			
			// Show this item if it was previously hidden
			if (itemClass == 'mce-fontawesome-panel-accordion mce-fontawesome-panel-accordion-hide') {
				var accordionItemContent = this;
				do accordionItemContent = accordionItemContent.nextSibling; while(accordionItemContent && accordionItemContent.nodeType !== 1);
		 
				accordionItemContent.style.height = "auto";
				var divHeight = accordionItemContent.offsetHeight;
				accordionItemContent.style.height = "";
				this.parentNode.className = 'mce-fontawesome-panel-accordion';
				var that = this;
				window.setTimeout(function () {
					accordionItemContent.style.height = divHeight + 'px';
				}, 50);
			}
		}
		
		function getFirstChildWithTagName( element, tagName) {
			for (var i = 0; i < element.childNodes.length; i++) {
				if (element.childNodes[i].nodeName == tagName) {
					return element.childNodes[i];
				}
			}
		}
    }
	
	editor.on('init', function() {
		csslink = editor.dom.create('link', {
			rel: 'stylesheet',
			href: url + '/css/fontawesome.min.css'
		});
		document.getElementsByTagName('head')[0].appendChild(csslink);
	});
	
    editor.addButton('fontawesome', {
		icon: 'flag',
        text: 'Icons',
        tooltip: 'Icons',
        onclick: showDialog
    });

    editor.addMenuItem('fontawesome', {
		icon: 'flag',
        text: 'Icons',
        onclick: showDialog,
        context: 'insert'
    });
});